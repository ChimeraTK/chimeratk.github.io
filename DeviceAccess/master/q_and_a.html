<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ChimeraTK-DeviceAccess: Questions and Answers</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ChimeraTK_Logo_whitebg.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ChimeraTK-DeviceAccess
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('q_and_a.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Questions and Answers </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This page is answering questions which users have asked when working with the DeviceAccess Library.</p>
<h1><a class="anchor" id="why_no_accessor_assignment"></a>
Why do RegisterAccessors not have an assignment operator for other RegisterAccessors?</h1>
<p>We decided to explicitly disable the assignmet of one accessor to another because it is ambiguous what the excpected behaviour is:</p><ul>
<li>Assign the data values of the other accessor?</li>
<li>Replace the complete accessor, incl. the register it points to. Depending on the contect where you use it you might expect either, so we decided to disable it to avoid unexpected behaviour.</li>
</ul>
<p>Use explicit conversion and replace() (defined in the NDRegisterAccessorBridge base class) to disctinguish which functionalitily you want:</p>
<div class="fragment"><div class="line"><span class="comment">// Note: This is calling the copy constructor, not the assignment operator.</span></div><div class="line"><span class="keyword">auto</span> a = _device-&gt;getScalarRegisterAccessor&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;REG_A&quot;</span>);</div><div class="line"><span class="keyword">auto</span> b = _device-&gt;getScalarRegisterAccessor&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;REG_B&quot;</span>);</div><div class="line"> </div><div class="line">a = int(b);   <span class="comment">// replace the value of &#39;a&#39; with the value of &#39;b&#39;</span></div><div class="line">a.replace(b); <span class="comment">// replace the whole accessor, now &#39;a&#39; points to REG_B</span></div></div><!-- fragment --><h3>Details:</h3>
<p>The original implementation had the default assignment operator which would replace the whole accessor, incl. the register it points to. This is what you need in the constructor of a class to initialise its member accessors: </p><div class="fragment"><div class="line"><span class="comment">// in the header (class definition)</span></div><div class="line">ScalarRegisterAccessor&lt;int&gt; _a,_b;</div><div class="line"></div><div class="line"><span class="comment">// in the .cc file (implementation of the constructor)</span></div><div class="line">_a = _device-&gt;getScalarRegisterAccessor&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;REG_A&quot;</span>);</div><div class="line">_b = _device-&gt;getScalarRegisterAccessor&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;REG_B&quot;</span>);</div></div><!-- fragment --><p>In addition the Accessors have operators which let you treat it like the primitive data type it represents (or the std::vector of it):</p>
<div class="fragment"><div class="line">_a = 7;    <span class="comment">// Assigment for int works, explicitly defined</span></div><div class="line">_b.read();</div><div class="line">_a += _b;  <span class="comment">// Works through implicit conversion,</span></div><div class="line">           <span class="comment">// increases the content of _a by the content of _b.</span></div><div class="line">_a.write();</div></div><!-- fragment --><p>With the assignment operator, however, this leads to unexpected behaviour:</p>
<div class="fragment"><div class="line">_a = _b * 2; <span class="comment">// replaces the value  of _a with 2* value of _b</span></div><div class="line">_a = _b;     <span class="comment">// WHOOPS, _a now points to &quot;REG_B&quot;</span></div></div><!-- fragment --><p>If we would have designed the assignment operator to only replace the value, the initialisation of the variable would behave unintuitively:</p>
<div class="fragment"><div class="line"><span class="comment">// This works as expected because in fact the copy constructor is called, </span></div><div class="line"><span class="comment">// although the syntax uses the euqals sign.</span></div><div class="line"><span class="keyword">auto</span> c = _device-&gt;getScalarRegisterAccessor&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;REG_C&quot;</span>);</div><div class="line"></div><div class="line"><span class="comment">// This does not work. &#39;d&#39; is not initialised yet and the value assignment</span></div><div class="line"><span class="comment">// is called, which leads to an assertion because of null pointer</span></div><div class="line"><span class="comment">// dereferencing at run time.</span></div><div class="line">ScalarRegisterAccessor&lt;int&gt; d;</div><div class="line">d = _device-&gt;getScalarRegisterAccessor&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;REG_D&quot;</span>);</div></div><!-- fragment --><p>Hence, we decided that there is no intuitive implementation for the assigment operator and explicitly deactivated it. The last example assigning to <code>d</code> will already fail at compile time.</p>
<h1><a class="anchor" id="use_sequences"></a>
Why can I not read SEQUENCE registers?</h1>
<p>The entries SEQUENCE_DMA_0 etc. in the map file are a crutch to implement multiplexed 2D registers, together with the according AREA_MULTIPLEXED_SEQUENCE register. You cannot directly read them. The entry in the register catalogue only exists for historical implementation reasons. However, QtHardMon in versions 0.x used this entry to display the according channel of the 2D register, so it gave the impression you could directly read the sequence.</p>
<p>The registers SEQUENCE_DMA_xx and AREA_MULTIPLEXED_SEQUENCE_DMA together describe the register "DMA" (register name can vary). To get the accoding sequence use a 2D accessor of "DMA" and get the channel you want (see <a class="el" href="accessor2d.html">2D Register Accessors</a> example). In QtHardMon 1.x and newer, use the register DMA and also select the correct channel. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed May 22 2019 03:53:10 for ChimeraTK-DeviceAccess by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
