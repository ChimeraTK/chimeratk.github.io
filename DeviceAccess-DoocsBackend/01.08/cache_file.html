<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ChimeraTK-DeviceAccess-DoocsBackend: CacheFile Mechanism</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ChimeraTK_Logo_whitebg.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ChimeraTK-DeviceAccess-DoocsBackend
   &#160;<span id="projectnumber">01.08.00</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('cache_file.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">CacheFile Mechanism </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_doc_cache_file"></a></p>
<p>This feature is a workaroud to deal with long RegisterCatalogue fetch times for Doocs locations with huge property lists. It requires a description file to be provided to the backend.</p>
<p>To enable this feature, specify the cacheFile parameter in the applications ChimeraTK Device Descriptor (<b>cdd</b>):</p>
<pre class="fragment">(doocs:XFEL.RF/TIMER/LLA6M?cacheFile=Filename.xml)
</pre><p>Filename.xml describes the Doocs locations property list. An example file may look like this:</p>
<pre class="fragment">  &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;
  &lt;catalogue version=\"1.0\"&gt;
    &lt;register&gt;
      &lt;name&gt;/DUMMY&lt;/name&gt;
      &lt;length&gt;1&lt;/length&gt;
      &lt;access_mode&gt;&lt;/access_mode&gt;
      &lt;doocs_type_id&gt;1&lt;/doocs_type_id&gt;
      &lt;!--doocs id: INT--&gt;"
    &lt;/register&gt;"
  &lt;/catalogue&gt;";
</pre><h1><a class="anchor" id="autotoc_md0"></a>
Using DoocsBackend to Generate Xml Descriptor File</h1>
<p>The descriptor xml file may be user generated. It is also possible to make the DoocsBackend generate one. The steps below detail the process:</p><ul>
<li>Set cacheFile key in the cdd to the desired xml filename (eg. Filename.xml).</li>
<li>Start the server application and run it till Filename.xml is generated in the working directory.</li>
<li>Exit server application.</li>
</ul>
<h1><a class="anchor" id="autotoc_md1"></a>
Behaviour Specifics:</h1>
<ol type="1">
<li>The DoocsBackend always starts a background task for querying the Doocs location and creating a RegisterCatalogue from this information.</li>
<li>When a cacheFile xml is provided in the cdd, it is parsed to generate the RegisterCatalogue. The RegisterCatalogue fetched by background task in step.1 remains unused (except to replace the xml file on disk - see step.3).</li>
<li>In cases where cacheFile parameter is specified in cdd:<ul>
<li>cacheFile xml on disk is replaced with the RegisterCatalogue info from step.1, once this background task completes.</li>
<li>cacheFile xml is not modified if server application exits before task in step.1 is complete.</li>
</ul>
</li>
<li>If no cacheFile parameter is provided in the cdd, backend waits for the task in step.1 to complete. The generated RegisterCatalogue from this task is then used by the application, but will not be cached to disk as an xml file. </li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Dec 6 2023 04:58:18 for ChimeraTK-DeviceAccess-DoocsBackend by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
