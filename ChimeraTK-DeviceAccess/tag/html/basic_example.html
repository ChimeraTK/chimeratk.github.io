<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ChimeraTK-DeviceAccess: Basic Example</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ChimeraTK_Logo_whitebg.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ChimeraTK-DeviceAccess
   &#160;<span id="projectnumber">03.15.02</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('basic_example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Basic Example </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>To use the <a class="el" href="class_chimera_t_k_1_1_device.html" title="Class allows to read/write registers from device.">ChimeraTK::Device</a> class you need a so called "device map" file (dmap file). It is created manually and contains information which devices are used in your application. More information can be found on the page about <a class="el" href="dmap.html">Device Mapping</a>.</p>
<p>For the beinning all you need is the alias which identifies the device. In the <code>example.dmap</code> file there is just one entry: MY_DEVICE</p>
<p>Registers are accessed by so called <code>accessors</code>. The accessors contain a buffer which stores the data which is read from or written to the hardware using <code>read()</code> and <code>write()</code> functions. When not reading or writing you can efficiently access or modify the content at will, because it is modifying the internal buffer and not talking to the hardware.</p>
<p>In this basic example are using a register which holds one value. A single value is a scalar, so we are using the ScalarRegisterAccessor. Like all accessors, it is templated to a simple (user) data type and automatically does a data conversion to this type, if needed. The ScalarRegisterAccessor behaves just like the simple data type it represents, so you can just assign to it, add, subtact, multiply or divide it, print it, ... Usually you don't allocate a variable and copy the accessor content to it (which would be really inefficient in case of large data arrays), but just use the accessor.</p>
<div class="fragment"><div class="line"><span class="comment">// SPDX-FileCopyrightText: Deutsches Elektronen-Synchrotron DESY, MSK, ChimeraTK Project &lt;chimeratk-support@desy.de&gt;</span></div>
<div class="line"><span class="comment">// SPDX-License-Identifier: LGPL-3.0-or-later</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;ChimeraTK/Device.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ChimeraTK/Utilities.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * All information needed to access the device is</span></div>
<div class="line"><span class="comment"> * the device alias and the register names</span></div>
<div class="line"><span class="comment"> * (plus a .dmap file)</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="_check_file_offset_bits_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>() {</div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * Before you use a device you have to tell DeviceAccess</span></div>
<div class="line"><span class="comment">   * which dmap file to use.</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code" href="namespace_chimera_t_k.html#ac081e51ebc9ef4fe64b469290d39b7a2">ChimeraTK::setDMapFilePath</a>(<span class="stringliteral">&quot;example.dmap&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * Create a device. Make sure a device alias is present</span></div>
<div class="line"><span class="comment">   * in the dmap file.</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code" href="class_chimera_t_k_1_1_device.html">ChimeraTK::Device</a> myDevice(<span class="stringliteral">&quot;MY_DEVICE&quot;</span>);</div>
<div class="line">  myDevice.open();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * Registers are defined by a path, which consists of a hierarchy of</span></div>
<div class="line"><span class="comment">   * names separated by &#39;/&#39;. In this is example it is Module/Register.</span></div>
<div class="line"><span class="comment">   * In this basic example we use a register which contains a single value</span></div>
<div class="line"><span class="comment">   * (a scalar).</span></div>
<div class="line"><span class="comment">   *</span></div>
<div class="line"><span class="comment">   * The example device has a temperature controller with a set value.</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code" href="class_chimera_t_k_1_1_scalar_register_accessor.html">ChimeraTK::ScalarRegisterAccessor&lt;float&gt;</a> temperatureSetPoint =</div>
<div class="line">      myDevice.getScalarRegisterAccessor&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;TEMPERATURE_CONTROLLER/SET_POINT&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * To get the value from the device call read.</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  temperatureSetPoint.<a class="code" href="class_chimera_t_k_1_1_transfer_element_abstractor.html#a66980fe7b7c0dc937361e71b1750767f">read</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * Now you can treat the accessor as if it was a regular float variable.</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Current temperature set point is &quot;</span> &lt;&lt; temperatureSetPoint &lt;&lt; std::endl;</div>
<div class="line">  temperatureSetPoint += 1.5;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Temperature set point changed to &quot;</span> &lt;&lt; temperatureSetPoint &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * After you are done manipulating the accessor write it to the hardware.</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  temperatureSetPoint.<a class="code" href="class_chimera_t_k_1_1_transfer_element_abstractor.html#a281b905219e719a1a0cdbd9d8d42d1dd">write</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * It is good style to close the device when you are done, although</span></div>
<div class="line"><span class="comment">   * this would happen automatically once the device goes out of scope.</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  myDevice.close();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md0"></a>
Side note</h3>
<p>Although the initialisation syntax of <code>_temperatureSetPoint</code> in the example above uses the equals sign, this is calling the copy constructor. Accessors intentionally don't have assignment operators (see <a class="el" href="q_and_a.html#why_no_accessor_assignment">Why do RegisterAccessors not have an assignment operator for other RegisterAccessors?</a>).</p>
<p>If you want to initialise an accessor which is already created, use <code>replace()</code>. You need this for instance if the accessor is a class member and has already been instantiated before you call devcie.getXXXAccessor() in the constructor. </p><div class="fragment"><div class="line"><a class="code" href="class_chimera_t_k_1_1_scalar_register_accessor.html">ChimeraTK::ScalarRegisterAccessor&lt;float&gt;</a> temperatureSetPoint;</div>
<div class="line">temperatureSetPoint.<a class="code" href="class_chimera_t_k_1_1_n_d_register_accessor_abstractor.html#ab6e2e3825b61976c4ad61ec9d1a7f547">replace</a>(myDevice.getScalarRegisterAccessor&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;TEMPERATURE_CONTROLLER/SET_POINT&quot;</span>));</div>
</div><!-- fragment --><p>Next topic: <a class="el" href="accessor1d.html">Multi Value Registers (1D Register Accessors)</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="a_check_file_offset_bits_8c_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="_check_file_offset_bits_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition:</b> <a href="_check_file_offset_bits_8c_source.html#l00009">CheckFileOffsetBits.c:9</a></div></div>
<div class="ttc" id="aclass_chimera_t_k_1_1_scalar_register_accessor_html"><div class="ttname"><a href="class_chimera_t_k_1_1_scalar_register_accessor.html">ChimeraTK::ScalarRegisterAccessor</a></div><div class="ttdoc">Accessor class to read and write scalar registers transparently by using the accessor object like a v...</div><div class="ttdef"><b>Definition:</b> <a href="_scalar_register_accessor_8h_source.html#l00024">ScalarRegisterAccessor.h:24</a></div></div>
<div class="ttc" id="aclass_chimera_t_k_1_1_n_d_register_accessor_abstractor_html_ab6e2e3825b61976c4ad61ec9d1a7f547"><div class="ttname"><a href="class_chimera_t_k_1_1_n_d_register_accessor_abstractor.html#ab6e2e3825b61976c4ad61ec9d1a7f547">ChimeraTK::NDRegisterAccessorAbstractor::replace</a></div><div class="ttdeci">void replace(const NDRegisterAccessorAbstractor&lt; UserType &gt; &amp;newAccessor)</div><div class="ttdoc">Assign a new accessor to this NDRegisterAccessorAbstractor.</div><div class="ttdef"><b>Definition:</b> <a href="_n_d_register_accessor_abstractor_8h_source.html#l00065">NDRegisterAccessorAbstractor.h:65</a></div></div>
<div class="ttc" id="aclass_chimera_t_k_1_1_device_html"><div class="ttname"><a href="class_chimera_t_k_1_1_device.html">ChimeraTK::Device</a></div><div class="ttdoc">Class allows to read/write registers from device.</div><div class="ttdef"><b>Definition:</b> <a href="_device_8h_source.html#l00039">Device.h:39</a></div></div>
<div class="ttc" id="aclass_chimera_t_k_1_1_transfer_element_abstractor_html_a281b905219e719a1a0cdbd9d8d42d1dd"><div class="ttname"><a href="class_chimera_t_k_1_1_transfer_element_abstractor.html#a281b905219e719a1a0cdbd9d8d42d1dd">ChimeraTK::TransferElementAbstractor::write</a></div><div class="ttdeci">bool write(ChimeraTK::VersionNumber versionNumber={})</div><div class="ttdoc">Write the data to device.</div><div class="ttdef"><b>Definition:</b> <a href="_transfer_element_abstractor_8h_source.html#l00089">TransferElementAbstractor.h:89</a></div></div>
<div class="ttc" id="anamespace_chimera_t_k_html_ac081e51ebc9ef4fe64b469290d39b7a2"><div class="ttname"><a href="namespace_chimera_t_k.html#ac081e51ebc9ef4fe64b469290d39b7a2">ChimeraTK::setDMapFilePath</a></div><div class="ttdeci">void setDMapFilePath(std::string dmapFilePath)</div><div class="ttdoc">Set the location of the dmap file.</div><div class="ttdef"><b>Definition:</b> <a href="_utilities_8cpp_source.html#l00327">Utilities.cpp:327</a></div></div>
<div class="ttc" id="aclass_chimera_t_k_1_1_transfer_element_abstractor_html_a66980fe7b7c0dc937361e71b1750767f"><div class="ttname"><a href="class_chimera_t_k_1_1_transfer_element_abstractor.html#a66980fe7b7c0dc937361e71b1750767f">ChimeraTK::TransferElementAbstractor::read</a></div><div class="ttdeci">void read()</div><div class="ttdoc">Read the data from the device.</div><div class="ttdef"><b>Definition:</b> <a href="_transfer_element_abstractor_8h_source.html#l00057">TransferElementAbstractor.h:57</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Aug 27 2024 18:43:40 for ChimeraTK-DeviceAccess by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
