<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ChimeraTK-ApplicationCore: Conceptual overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ChimeraTK_Logo_whitebg.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ChimeraTK-ApplicationCore
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('conceptual_overview.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Conceptual overview </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="Introduction"></a>
Introduction</h1>
<p>Applications written with ApplicationCore are divided into modules. A module can have any number of input and output process variables. All program logic must be implemented into modules. One fundamental principle of ApplicationCore is that the inputs and outputs of modules can be connected to arbitrary targets like device registers, control system variables, other modules or even multiple targets at the same time. This does not involve any code change, so the author of the module does not need to keep this in mind while coding.</p>
<p>There are the following types of modules:</p>
<ul>
<li>Application module: Any application logic must go into this type of modules, so this type of modules is the main ingredience to the application.</li>
<li>Variable group: Can be used to organise variables hierarchically within application modules.</li>
<li>Module group: Can be used to organise ApplicationModules hierarchically within the application.</li>
<li>Device module: Represents a device (in the sense of <a class="el" href="namespace_chimera_t_k.html" title="InvalidityTracer application module.">ChimeraTK</a> DeviceAccess) or a part of such, and allows to connect device registers to other modules.</li>
<li>Control system module: Represents the control system variable household. Should normally not be used by the programmer.</li>
<li>The application: All other modules must be directly or indirectly instantiated by the application, which is basically the top-most module group.</li>
</ul>
<h1><a class="anchor" id="conceptualOverview_ApplicationModule"></a>
Application module</h1>
<p>An application module represents a small task of the total application, e.g. one particular computation. The task will be executed in its own thread, so it is well separated from the rest of the application. Ideally, each module should be somewhat self-contained and independent of other modules, and only ApplicationCore process variables should be used for communication with other parts of the application.</p>
<p>An application module is a class deriving from <a class="el" href="class_chimera_t_k_1_1_application_module.html">ChimeraTK::ApplicationModule</a>, e.g.: </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code" href="struct_my_module.html">MyModule</a> : <a class="code" href="class_chimera_t_k_1_1_application_module.html">ChimeraTK::ApplicationModule</a> {</div>
<div class="line">  <span class="keyword">using</span> <a class="code" href="class_chimera_t_k_1_1_application_module.html#a527d36175aa9b3126553b6a2a8933e38">ChimeraTK::ApplicationModule::ApplicationModule</a>;</div>
<div class="line">  <a class="code" href="struct_chimera_t_k_1_1_scalar_push_input.html">ctk::ScalarPushInput&lt;double&gt;</a> someInput{<span class="keyword">this</span>, <span class="stringliteral">&quot;someInput&quot;</span>, <span class="stringliteral">&quot;Unit&quot;</span>, <span class="stringliteral">&quot;Description&quot;</span>};</div>
<div class="line">  <a class="code" href="struct_chimera_t_k_1_1_scalar_output.html">ctk::ScalarOutput&lt;double&gt;</a> someOutput{<span class="keyword">this</span>, <span class="stringliteral">&quot;someOutput&quot;</span>, <span class="stringliteral">&quot;Unit&quot;</span>, <span class="stringliteral">&quot;Description&quot;</span>};</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="struct_my_module.html#a220b167c558bb5b3bcfc3783dfb5d0fa">mainLoop</a>() <span class="keyword">override</span>;</div>
<div class="line">};</div>
<div class="ttc" id="aclass_chimera_t_k_1_1_application_module_html"><div class="ttname"><a href="class_chimera_t_k_1_1_application_module.html">ChimeraTK::ApplicationModule</a></div><div class="ttdef"><b>Definition:</b> <a href="_application_module_8h_source.html#l00023">ApplicationModule.h:23</a></div></div>
<div class="ttc" id="aclass_chimera_t_k_1_1_application_module_html_a527d36175aa9b3126553b6a2a8933e38"><div class="ttname"><a href="class_chimera_t_k_1_1_application_module.html#a527d36175aa9b3126553b6a2a8933e38">ChimeraTK::ApplicationModule::ApplicationModule</a></div><div class="ttdeci">ApplicationModule()=default</div><div class="ttdoc">Default constructor: Allows late initialisation of modules (e.g.</div></div>
<div class="ttc" id="astruct_chimera_t_k_1_1_scalar_output_html"><div class="ttname"><a href="struct_chimera_t_k_1_1_scalar_output.html">ChimeraTK::ScalarOutput&lt; double &gt;</a></div></div>
<div class="ttc" id="astruct_chimera_t_k_1_1_scalar_push_input_html"><div class="ttname"><a href="struct_chimera_t_k_1_1_scalar_push_input.html">ChimeraTK::ScalarPushInput&lt; double &gt;</a></div></div>
<div class="ttc" id="astruct_my_module_html"><div class="ttname"><a href="struct_my_module.html">MyModule</a></div><div class="ttdef"><b>Definition:</b> <a href="test_model_8cc_source.html#l00022">testModel.cc:22</a></div></div>
<div class="ttc" id="astruct_my_module_html_a220b167c558bb5b3bcfc3783dfb5d0fa"><div class="ttname"><a href="struct_my_module.html#a220b167c558bb5b3bcfc3783dfb5d0fa">MyModule::mainLoop</a></div><div class="ttdeci">void mainLoop() override</div><div class="ttdoc">To be implemented by the user: function called in a separate thread executing the main loop of the mo...</div><div class="ttdef"><b>Definition:</b> <a href="test_model_8cc_source.html#l00038">testModel.cc:38</a></div></div>
</div><!-- fragment --><p> In this small example, one input and one output process variable is defined (see <a class="el" href="conceptual_overview.html#conceptualOverview_ProcessVariable">next section</a>). The code processing the data needs to go into the implementation of the ApplicationModule::mainLoop() function implementation, e.g.: </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="struct_my_module.html#a220b167c558bb5b3bcfc3783dfb5d0fa">MyModule::mainLoop</a>() {</div>
<div class="line">  <span class="keywordflow">while</span>(<span class="keyword">true</span>) {</div>
<div class="line">    <span class="comment">// data processing happens here</span></div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p> The mainLoop function litteraly needs to contain a loop, which runs for the lifetime of the application. Any preparations which need to be executed once at application start should go before the start of the loop. Alternatively, a function ApplicationModule::prepare() can be implemented, which will be executed at an earlier state of the startup phase, before any of the other mainLoop threads are started.</p>
<p>During shutdown of the application, any read/write operation on the process variables will function as an interruption point. If required, a try-catch block for the boost::thread_interrupted exception will allow to execute any code during shutdown (but keep in mind most functionality like access to devices will not be available any more at that point).</p>
<h1><a class="anchor" id="conceptualOverview_ProcessVariable"></a>
Process variables and accessors</h1>
<h2><a class="anchor" id="conceptualOverview_ProcessVariable_intro"></a>
Introduction</h2>
<p>What has been previously in this document referred to as a process variable is actually only the accessor to it. Accessors are already known from <a class="el" href="namespace_chimera_t_k.html" title="InvalidityTracer application module.">ChimeraTK</a> DeviceAccess, where they allow reading and writing from/to device registers. In ApplicationCore the concept is extended to a higher abstraction level, since accessors cannot only target device registers.</p>
<p>A process variable has a data source, which is called the feeder, and one or more so-called consumers. The feeder as well as any consumer can each be either a device register, a control system variable (e.g. from an operator panel) or an output accessor of an application module. Process variables have a name, a type, a physical unit, a description and of course a value.</p>
<h2><a class="anchor" id="conceptualOverview_ProcessVariable_accessMode"></a>
Push and poll transfer modes</h2>
<p>Accessors can have either push or poll type transfer modes. In push mode, the feeder initiates the data tranfers, while in poll mode the consumer does. In both cases, a consuming application module still needs to execute a read operation before the value becomes visible in the application buffer of the accessor.</p>
<p>Push inputs of application modules are accessors with the ChimeraTK::AccessMode::wait_for_new_data flag (see DeviceAccess documentation) and hence have a blocking ChimeraTK::TransferElement::read() operation which waits until data is available for reading. They also support ChimeraTK::TransferElement::readNonBlocking() and ChimeraTK::TransferElement::readLatest(), and can be used inside a ChimeraTK::ReadAnyGroup.</p>
<p>Poll inputs do not have the AccessMode::wait_for_new_data flag, and hence all read operations do not block and do not inform about changed values.</p>
<p>Outputs of application modules are always push-type, so they can be connected to either a push-type or a poll-type input. Device registers do not neccessarily support the AccessMode::wait_for_new_data flag, in which case a direct connetion with only poll-type readers is possible. To circumvent this, a trigger can be used which determines the point in time when a new value shall be polled, see the <a class="el" href="conceptual_overview.html#conceptualOverview_DeviceModule">Section Device modules</a> for more details. Control system variables are always push-type, which means device registers often cannot be connected directly to the control system without a trigger.</p>
<h2><a class="anchor" id="conceptualOverview_ProcessVariable_hierarchy"></a>
Name and hierarchies</h2>
<p>The fully qualified name of a process variable includes the entire hierarchy of modules, which is formed by the combination of ModuleGroups, the ApplicationModule and VariableGroups. All accessors referring to the same fully qualified variable name will access the same logical process variable and hence will be connected and receive the same values.</p>
<h2><a class="anchor" id="conceptualOverview_ProcessVariable_network"></a>
Variable networks</h2>
<p>Each process variable is represented by a VariableNetwork. The programmer normally does not have to deal with variable networks directly, but it is possible to print out all networks of an application for debugging purposes (cf. Application::dumpConnections()). Each feeder or consumer is represented by a VariableNetworkNode. Also with these the programmer does not need to deal normally, but they can be used to connect variables explicitly.</p>
<h2><a class="anchor" id="conceptualOverview_ProcessVariable_metainfo"></a>
Type and meta information</h2>
<h1><a class="anchor" id="conceptualOverview_VariableGroup"></a>
Variable groups</h1>
<h1><a class="anchor" id="conceptualOverview_ModuleGroup"></a>
Module groups</h1>
<h1><a class="anchor" id="conceptualOverview_DeviceModule"></a>
Device modules</h1>
<h2><a class="anchor" id="conceptualOverview_DeviceModule_trigger"></a>
Triggers</h2>
<h1><a class="anchor" id="conceptualOverview_ControlSystemModule"></a>
Control system module</h1>
<h1><a class="anchor" id="conceptualOverview_Application"></a>
The Application</h1>
<h1><a class="anchor" id="conceptualOverview_Connections"></a>
Process variable connections</h1>
<h1><a class="anchor" id="conceptualOverview_FanOuts"></a>
Fanouts</h1>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">index</a></li>
    <li class="footer">Generated on Wed Jun 7 2023 03:53:53 for ChimeraTK-ApplicationCore by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
