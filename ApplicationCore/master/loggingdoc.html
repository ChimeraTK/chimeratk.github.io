<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ChimeraTK-ApplicationCore: Logging module and Logger</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ChimeraTK_Logo_whitebg.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ChimeraTK-ApplicationCore
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('loggingdoc.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Logging module and Logger </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Klaus Zenker (HZDR) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>03.04.2018</dd></dl>
<h1><a class="anchor" id="loggingintro"></a>
Introduction to the logging mechanism</h1>
<p>The logging provided here requires to add the LoggingModule to your Application. The module introduces the following input variables, that need to be connected to the control system:</p><ul>
<li>targetStream: Allows to choose where messages send to the logging module end up:<ul>
<li>0: cout/cerr+logfile</li>
<li>1: logfile</li>
<li>2: cout/cerr</li>
<li>3: controlsystem only</li>
<li>4: nowhere</li>
</ul>
</li>
<li>logFile: Give the logfile name. If the file is not empty logging messages will be appended. If you choose targetStream 0 or 1 and don't set a logFile the Logging module simply skips the file writing.</li>
<li>logLevel: Choose a certain logging level of the Module. Messages send to the Logging module also include a logging level. The Logging module compares both levels and decides if a message is dropped (e.g. message level is DEBUG and Module level is ERROR) or broadcasted.</li>
<li>maxTailLength: The number of messages published by the Logging module (see logTail), i.e. to the control system. If set to 0 the number of messages defaults to 20. This length has no influence on the targetStreams, that receive all messages (depending on the logLevel). The logLevel also applies to messages that are published by the Logging module via the logTail</li>
</ul>
<p>Available logging levels are:</p><ul>
<li>DEBUG</li>
<li>INFO</li>
<li>WARNING</li>
<li>ERROR</li>
<li>SILENT</li>
</ul>
<p>The only variable that is published by the Logging module is the logTail. It contains the list of latest messages. Messages are separated by a newline character. The number of messages published in the logTail is set via the input variable tailLength. Other than that, messages are written to cout/cerr and/or a log file as explained above.</p>
<p>A Logger class is used to send messages to the LoggingModule. The foreseen way of using the Logger is to add a Logger to a module that should send log messages.</p>
<p>The LoggingModule will take care of finding all Loggers. Therefore, the LoggingModule needs to be constructed last - after all ApplicationModules using a Logger are constructed. It will look in its owner for all accessors with tags that match the tags given to the LoggingModule. Like that one can use tags in the Logger to assign senders for the LoggingModule and in addition the LoggingModule can be placed inside a ModuleGroup to consider only accessors in that group when setting up the connections.</p>
<p>The following example shows how to integrate the Logging module and the Logging into an application (myApp) and one module sending messages (<a class="el" href="struct_test_module.html">TestModule</a>). </p><div class="fragment"><div class="line">sruct <a class="code" href="struct_test_module.html">TestModule</a>: <span class="keyword">public</span> <a class="code" href="class_chimera_t_k_1_1_application_module.html">ChimeraTK::ApplicationModule</a>{</div><div class="line"><span class="comment">// use default tag of the Logger -&gt; &quot;Logging&quot;</span></div><div class="line">boost::shared_ptr&lt;Logger&gt; logger{<span class="keyword">new</span> Logger(<span class="keyword">this</span>)};</div><div class="line">...</div><div class="line">};</div><div class="line"><span class="keyword">struct </span>myApp : <span class="keyword">public</span> <a class="code" href="class_chimera_t_k_1_1_application.html">ChimeraTK::Application</a>{</div><div class="line"></div><div class="line"></div><div class="line"><a class="code" href="class_chimera_t_k_1_1_control_system_module.html">ChimeraTK::ControlSystemModule</a> cs;</div><div class="line"></div><div class="line"><a class="code" href="struct_test_module.html">TestModule</a> { <span class="keyword">this</span>, <span class="stringliteral">&quot;test&quot;</span>, <span class="stringliteral">&quot;&quot;</span> };</div><div class="line"></div><div class="line"><span class="comment">// needs to be added after all modules that use a Logger!</span></div><div class="line"><span class="comment">// Default tag of the LoggingModule is used -&gt; &quot;Logging&quot;</span></div><div class="line">LoggingModule log { <span class="keyword">this</span>, <span class="stringliteral">&quot;LoggingModule&quot;</span>, <span class="stringliteral">&quot;LoggingModule test&quot;</span> };</div><div class="line">...</div><div class="line">};</div><div class="line"></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> myAPP::defineConnctions(){</div><div class="line">log.<a class="code" href="class_chimera_t_k_1_1_entity_owner.html#a10abe5f666483380a4dee7fb8caacd86">findTag</a>(<span class="stringliteral">&quot;CS&quot;</span>).<a class="code" href="class_chimera_t_k_1_1_virtual_module.html#a2fbf47f6be36e9ebcf8abf3d3f955741">connectTo</a>(cs);</div><div class="line">...</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> <a class="code" href="struct_test_module.html#a7d6840590346a5b8b9f9d8b045611a56">TestModule::mainLoop</a>{</div><div class="line">  logger.sendMessage(<span class="stringliteral">&quot;Test&quot;</span>,<a class="code" href="namespacelogging.html#a12e05573477c76b8d6db5081863f4416a682501b7fb187303796e3f533735b51f">LogLevel::DEBUG</a>);</div><div class="line">  ...</div><div class="line">}</div></div><!-- fragment --><p>A message always looks like this: LogLevel::LoggingModuleName/SendingModuleName TimeString -&gt; message<br />
 In the example given above the message could look like: </p><div class="fragment"><div class="line">DEBUG::LogggingModule/test 2018-Apr-12 14:03:07.947949 -&gt; Test</div></div><!-- fragment --> <dl class="section remark"><dt>Remarks</dt><dd>Instead of adding a Logger to every module that should feed the Logging module, one could also consider using only one Logger object. This is not thread safe and would not work for multiple modules trying to send messages via the Logger object to the Logging module at the same time.</dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>If sendMessage is called multiple times in a sequence some messages might get lost. This is because of the internal buffer used by <a class="el" href="namespace_chimera_t_k.html" title="InvalidityTracer application module. ">ChimeraTK</a>, that has a size of 3. If the LoggingModule is not done processing a message, the internal buffer is full and a new message arrives it is dropped. </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">index</a></li>
    <li class="footer">Generated on Thu Jun 16 2022 03:55:13 for ChimeraTK-ApplicationCore by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
